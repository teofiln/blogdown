<!doctype html>



 <html class="no-js" lang=""> 
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Teofil Nakov</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">

  <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro|Source+Serif+Pro|Source+Sans+Pro:400,600" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" crossorigin="anonymous">

  <link rel="stylesheet" href=/css/main.css>
  <link rel="stylesheet" href=/css/magnific-popup.css>

  


<html>
  <body lang="en">
  


  <div id="main">
    

<div id="nav">
  
  <a href="/img/hassall-transparent.png" class="image-link">
    <img class="logo animated flipInY" src="/img/hassall-transparent.png"/>
  </a>
  
  
  <ul>
    
      <li><a href="/about/">
          <span>About</span>
      </a></li>
    
      <li><a href="/papers/">
          <span>Papers</span>
      </a></li>
    
      <li><a href="/meetings/">
          <span>Meetings</span>
      </a></li>
    
  </ul>

</div>

    <h1 class="animated flipInX"><a href="/2019/01/22/test/">test</a></h1>
    <p class="post-info animated fadeIn">200 Words | Approximately 1 Minutes Read | Last Modified on January 22, 2019
    


<p>One of the checks if the SNPs called in an analysis are sound, is to take a look at the ratio of transitions to transversions (T_i/T_v). If mutations were random, we expect to see a T_i/T_v of 0.5, because there are twice as many types of transversions as there are transitions. But, of course, transitions (purine-to-purine or pirimidine-to-pirimidine) and transversions (between purines and pirimidines) are not equally likelyâ€”transitions are much more common than transitions. So after filtering a <code>vcf</code> file we generally expect to enrich the pool of SNPs for higher-quality calls. This in turn should increase a bit the T_i/T_v.</p>
<pre class="r"><code>vcf_ti_tv_ratio &lt;- function(vcf) {
  purines &lt;- c(&quot;A&quot;, &quot;G&quot;)
  pirimidines &lt;- c(&quot;C&quot;, &quot;T&quot;)
  snps &lt;- filter(vcf, TYPE==&quot;snp&quot;) %&gt;% filter(str_length(REF) == 1 &amp; str_length(REF) == 1)
  total_snps &lt;- nrow(snps)
  transitions &lt;- snps %&gt;% filter(REF %in% purines &amp; ALT %in% purines | REF %in% pirimidines &amp; ALT %in% pirimidines)
  total_transitions &lt;- nrow(transitions)
  total_transversions &lt;- total_snps - total_transitions
  return(c(snps=total_snps, 
           transitions=total_transitions, 
           transversions=total_transversions, 
           ti_tv_ratio=total_transitions/total_transversions))
}</code></pre>



    
  </div>

  



<div id="sidebar">
  
  <a href="/img/hassall-transparent.png" class="image-link">
    <img class="logo animated flipInY" src="/img/hassall-transparent.png"/>
  </a>
  

  <h2></h2>
  <ul>
    
      <li><a href="/about/">About</a></li>
    
      <li><a href="/papers/">Papers</a></li>
    
      <li><a href="/meetings/">Meetings</a></li>
    
  </ul>
  
  <h2>Contact</h2>
  <ul>
    
      <li><a href="mailto:teofiln@gmail.com">Email</a></li>
    
      <li><a href="https://github.com/teofiln">Github</a></li>
    
      <li><a href="https://twitter.com/teofilnakov">Twitter</a></li>
    
  </ul>
  
  <h2>Projects</h2>
  <ul>
    
      <li><a href="/div/" target="_blank">Diversification</li>
    
      <li><a href="trans" target="_blank">Salinity &amp; transcriptomes</li>
    
      <li><a href="baltic" target="_blank">Salinity &amp; genomes</li>
    
      <li><a href="genomics" target="_blank">Genome evolution</li>
    
      <li><a href="phylo" target="_blank">Phylogenetics &amp; diversity</li>
    
  </ul>
  
  <h2>Recent posts</h2>
  <ul>
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
  </ul>
</div>

  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
  <script src=/js/jquery-1.11.2.min.js></script>
  <script src=/js/main.js></script>

  
  <script src=/js/jquery.magnific-popup.min.js></script>

  
  

  
</body>
</html>

