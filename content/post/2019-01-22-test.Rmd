---
title: test
author: teo
date: '2019-01-22'
slug: test
categories: []
tags: []
---


One of the checks if the SNPs called in an analysis are sound, is to take a look at the ratio of transitions to transversions (T_i/T_v). If mutations were random, we expect to see a T_i/T_v of 0.5, because there are twice as many types of transversions as there are transitions. But, of course, transitions (purine-to-purine or pirimidine-to-pirimidine) and transversions (between purines and pirimidines) are not equally likely---transitions are much more common than transitions. So after filtering a `vcf` file we generally expect to enrich the pool of SNPs for higher-quality calls. This in turn should increase a bit the T_i/T_v.

```{r}
vcf_ti_tv_ratio <- function(vcf) {
  purines <- c("A", "G")
  pirimidines <- c("C", "T")
  snps <- filter(vcf, TYPE=="snp") %>% filter(str_length(REF) == 1 & str_length(REF) == 1)
  total_snps <- nrow(snps)
  transitions <- snps %>% filter(REF %in% purines & ALT %in% purines | REF %in% pirimidines & ALT %in% pirimidines)
  total_transitions <- nrow(transitions)
  total_transversions <- total_snps - total_transitions
  return(c(snps=total_snps, 
           transitions=total_transitions, 
           transversions=total_transversions, 
           ti_tv_ratio=total_transitions/total_transversions))
}
```

