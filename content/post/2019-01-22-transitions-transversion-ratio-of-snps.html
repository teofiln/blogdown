---
title: R function to calculate transitions/transversion ratio of SNPs from a VCF file
author: Teo
date: '2019-01-22'
slug: ti-tv-ratio-of-snps-in-vcf
categories: ["R"]
tags: ["R", "Skeletonema", "Baltic Sea", "SNPs", "VCF"]
draft: true
---



<p>One of the checks if the SNPs called in an analysis are sound, is to take a look at the ratio of transitions to transversions (T_i/T_v). If mutations were random, we expect to see a T_i/T_v of 0.5, because there are twice as many types of transversions as there are transitions. But, of course, transitions (purine-to-purine or pirimidine-to-pirimidine) and transversions (between purines and pirimidines) are not equally likelyâ€”transitions are much more common than transitions. So after filtering a <code>vcf</code> file we generally expect to enrich the pool of SNPs for higher-quality calls. This in turn should increase a bit the T_i/T_v.</p>
<pre class="r"><code>vcf_ti_tv_ratio &lt;- function(vcf) {
  purines &lt;- c(&quot;A&quot;, &quot;G&quot;)
  pirimidines &lt;- c(&quot;C&quot;, &quot;T&quot;)
  snps &lt;- filter(vcf, TYPE==&quot;snp&quot;) %&gt;% filter(str_length(REF) == 1 &amp; str_length(REF) == 1)
  total_snps &lt;- nrow(snps)
  transitions &lt;- snps %&gt;% filter(REF %in% purines &amp; ALT %in% purines | REF %in% pirimidines &amp; ALT %in% pirimidines)
  total_transitions &lt;- nrow(transitions)
  total_transversions &lt;- total_snps - total_transitions
  return(c(snps=total_snps, 
           transitions=total_transitions, 
           transversions=total_transversions, 
           ti_tv_ratio=total_transitions/total_transversions))
}</code></pre>
